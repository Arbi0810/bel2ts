var wppizzaCartJson={},wppizzaUpdateCart=function(){},wppizzaTotalsBefore=function(){},wppizzaTotals=function(){},wppizzaRestoreOrder=function(){},wppizzaPrepareOrder=function(){},wppizzaPrettifyJsAlerts=function(){};jQuery(document).ready(function(l){wppizza.shopOpen=-1,void 0===wppizza.usingCache&&(wppizza.shopOpen=0<l(".wppizza-open").length);function c(a){wppizzaCartJson=0<l("#wppizza-cart-json").length&&"empty"!==a?JSON.parse(l("#wppizza-cart-json").val()):{}}c("ini");var r=0<l(".wppizza-cart").length||0<l(".wppizza-cart-novis").length||0<l(".wppizza-totals").length||0<l("#wppizza-minicart").length,a=0<l(".wppizza-login-form").length,n=void 0!==wppizza.isCheckout,t=void 0!==wppizza.reCalc,s=void 0!==wppizza.cfrm,u=!1,w=void 0!==wppizza.pjsa,o=void 0!==wppizza.fpt,m=!1,z="wppizza-send-order",v=!1;wppizza.ajaxStart_count=0,l(document).ajaxStart(function(){wppizza.ajaxStart_count++}),wppizza.spinner_count=0,l(document).ajaxStop(function(){0==wppizza.spinner_count&&B("complete"),u||_()}),l(document).ajaxComplete(function(a,t,i){Q()}),l(document).ajaxError(function(a,t,i,e){console.log("error :"),console.log(e),console.log(i),console.log(t.responseText),_()}),l(document).ajaxStop(function(){m&&(O(wppizza.funcCartRefr,m),m=!1)}),wppizzaPrettifyJsAlerts=function(a,t){var i=(i=(new DOMParser).parseFromString(wppizza.pjsa.h1,"text/html")).documentElement.textContent,e=wppizza.pjsa.ok;d=document,d.getElementById("wppizzaJsAlert")||(mObj=d.getElementsByTagName("body")[0].appendChild(d.createElement("div")),mObj.id="wppizzaJsAlert",mObj.style.height=d.documentElement.scrollHeight+"px",alertObj=mObj.appendChild(d.createElement("div")),alertObj.id="wppizzaAlertBox",d.all&&!window.opera&&(alertObj.style.top=document.documentElement.scrollTop+"px"),alertObj.style.left=(d.documentElement.scrollWidth-alertObj.offsetWidth)/2+"px",alertObj.style.visiblity="visible",h1=alertObj.appendChild(d.createElement("div")),h1.id="wppizzaAlertTitle",h1.appendChild(d.createTextNode(i)),msg=alertObj.appendChild(d.createElement("p")),msg.innerHTML=a,btn_wrap=alertObj.appendChild(d.createElement("div")),btn_wrap.id="btnWrap",btn_ok=btn_wrap.appendChild(d.createElement("button")),btn_ok.id="wppizzaAlertOk",btn_ok.innerHTML=e,btn_ok.onclick=function(){return p(!0),!1},alertObj.style.display="block")};var p=function(a){document.getElementsByTagName("body")[0].removeChild(document.getElementById("wppizzaJsAlert"))};wppizzaPrepareOrder=function(a){var t=l("#wppizza-send-order").serialize();jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"prepareorder",gateway_selected:a,data:t}},function(a){if(void 0!==a.error){var i=[],e=[];l.each(a.error,function(a,t){i[a]=t.error_id,e[a]=t.error_message});var t="ERROR: "+i.join("|")+"\n";return t+=""+e.join("\n"),void(w?wppizzaPrettifyJsAlerts(t,"alert"):alert(t))}m=!1},"json")},wppizzaRestoreOrder=function(){_(),l(".wppizza-ordernow, #wppizza-ordernow").attr("disabled",!1)};function f(a,t){void 0===a&&(a=!1),void 0===t&&(t=!1),n?a||(l("html").css({position:"relative"}),l("body").prepend('<div class="wppizza-loading"></div>'),l(".wppizza-ordernow").attr("disabled","true")):a&&t?a.prepend('<div class="'+t+'"></div>'):l(".wppizza-cart").prepend('<div class="wppizza-loading"></div>')}function h(){var a=l('input[type="hidden"][name="wppizza_gateway_selected"]'),t=l('input[type="radio"][name="wppizza_gateway_selected"]:checked'),i=l('select[name="wppizza_gateway_selected"] option:selected'),e="";return 0<a.length?e=a.val().toLowerCase():0<t.length?e=t.val().toLowerCase():0<i.length&&(e=i.val().toLowerCase()),e}function g(){return-1!==wppizza.shopOpen&&(!(!wppizza.shopOpen&&r)||(w?wppizzaPrettifyJsAlerts(wppizza.msg.closed,"alert"):alert(wppizza.msg.closed),!1))}var _=function(a,t){var i;void 0===a&&(a=!1),void 0===t&&(t=!1),a&&t?a.find("."+t).remove():0<(i=l(".wppizza-loading")).length&&l.each(i,function(a,t){l(this).remove()})},y=h();if(n&&window.performance&&2===window.performance.navigation.type)return f(),void window.location.reload(!0);wppizzaUpdateCart=function(a){if(f(),void 0!==a.markup&&void 0!==a.markup&&void 0!==a.markup)return j(a.markup),wppizza.shopOpen=a.is_open,void(m=a.cart);jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"loadcart",isCheckout:n}},function(a){j(a.markup),wppizza.shopOpen=a.is_open,m=a.cart,c("loadcart")},"json")};function e(a){"refresh"==a&&f(),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"loadcart",isCheckout:n}},function(a){j(a.markup),wppizza.shopOpen=a.is_open,m=a.cart,c("update_cart")},"json")}var j=function(p){var a=l(".wppizza-cart");l.each(a,function(a,t){var i=l(this).attr("id"),e=i.split("-").pop(-1);e<=0||""==e?l(this).html(p):(l(this).html(p),l("#"+i+" .wppizza-order-itemised > tbody").css({height:e+"px","min-height":e+"px","max-height":e+"px"}))})};r&&(void 0!==wppizza.usingCache&&e("load"),l(document).on("click",".wppizza-cart-refresh",function(a){e("refresh")}));function k(a,t){if(0<a.length)for(i=0;i<a.length;i++){new Function("term","return "+a[i]+"(term);")(t)}}var b,C,O=function(a,t){if(0<a.length)for(i=0;i<a.length;i++){new Function("term","return "+a[i]+"(term);")(t)}B("refresh"),wppizza.spinner_count++};0<l(".wppizza-totals-container").length&&(b=l(".wppizza-totals-viewcart, .wppizza-totals-viewcart-button"),C=l(".wppizza-totals-cart"),0<b.length&&(l(document).on("click",".wppizza-totals-container>.dashicons-cart, .wppizza-totals-viewcart-button",function(a){l(this).closest("div").find(".wppizza-totals-cart").fadeToggle()}),l("html").click(function(a){var t=l(a.target);if(!t.is("#wppizza-minicart .ui-spinner-input, #wppizza-minicart .ui-spinner-button, #wppizza-minicart .ui-icon")){if(t.is(".wppizza-totals-container>.dashicons-cart, .wppizza-totals-viewcart-button>input"))if(t.closest("div").find(".wppizza-totals-cart").is(":visible"))return;C.is(":visible")&&C.fadeOut()}})),(wppizzaTotalsBefore=function(a){void 0===a&&(a=!1);var t=l(".wppizza-totals-container");!0!==a&&f(t,"wppizza-loading-small")})(!0),(wppizzaTotals=function(a){void 0===a&&(a=!1);var t=l(".wppizza-totals-container"),i=l(".wppizza-totals-order"),e=l(".wppizza-totals-items"),o=l(".wppizza-totals-itemcount"),r=l(".wppizza-totals-checkout-button"),n=l(".wppizza-totals-viewcart"),s=l(".wppizza-totals-viewcart-button"),d=l(".wppizza-totals-emptycart-button"),z=l(".wppizza-totals-cart");l(".wppizza-totals-cart-items"),l(".wppizza-totals-cart-summary");jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"gettotals"}},function(p){P.length<=0&&0<T.length&&(void 0!==p.get_cart_json?0<l("#wppizza-minicart > #wppizza-cart-json").length?(l("#wppizza-minicart > #wppizza-cart-json").replaceWith(p.get_cart_json),c("minicart-update")):(T.prepend(p.get_cart_json),c("minicart-ini")):(l("#wppizza-minicart > #wppizza-cart-json").empty().remove(),c("minicart-empty"))),0<p.no_of_items?(t.removeClass("wppizza-totals-no-items"),t.addClass("wppizza-totals-has-items")):(t.removeClass("wppizza-totals-has-items"),t.addClass("wppizza-totals-no-items")),0<z.length&&0<n.length&&(n.hasClass("dashicons-cart")||n.addClass("dashicons dashicons-cart"),""!=p.cart_empty?n.hide():n.show()),p.is_open&&(wppizza.shopOpen=!0),0<s.length&&s.html(p.view_cart_button),0<i.length&&i.html(p.total),0<e.length&&e.html(p.total_price_items),0<o.length&&o.html(p.itemcount),0<r.length&&r.html(p.checkout_button),0<o.length&&d.html(p.emptycart_button),0<z.length&&l.each(z,function(a,t){var i=l(this),e="";i.hasClass("wppizza-totals-cart-items")&&(e+=p.items),i.hasClass("wppizza-totals-cart-summary")&&(e+=p.summary),void 0!==p.minimum_order&&(e+=p.minimum_order),i.html(e),v&&B("minicart-cart_markup")}),!0!==a&&_(t,"wppizza-loading-small"),v=!(m=!1)},"json")})(!0));var x,T=l("#wppizza-minicart"),P=l(".wppizza-cart");0<T.length&&(function(){void 0!==wppizza.crt.mElm&&T.prependTo(""+wppizza.crt.mElm);var a,t,i,e,p=wppizza.crt.mCartPadTop;void 0!==wppizza.crt.mPadTop&&0<wppizza.crt.mPadTop&&(p=wppizza.crt.mPadTop,(a=void 0!==wppizza.crt.mPadElm?l(""+wppizza.crt.mPadElm):l("body")).css({"padding-top":"+="+wppizza.crt.mPadTop+"px"})),void 0===wppizza.crt.mStatic&&(t=l(window),i=!0,setTimeout(function(){x(t,T,P,p,a),i=!1},500),t.scroll(function(){i||(clearTimeout(e),e=setTimeout(function(){x(t,T,P,p,a)},300))}),t.resize(function(){i||(clearTimeout(e),e=setTimeout(function(){x(t,T,P,p,a)},300))}))}(),x=function(a,t,i,e,p){var o,r,n,s,d,z=a.width();void 0!==wppizza.crt.mMaxWidth&&(o=wppizza.crt.mMaxWidth),void 0!==o&&o<z||void 0!==wppizza.isCheckout?t.is(":visible")&&t.fadeOut(250):((d=!(0<i.length)||(n=(r=a.scrollTop())+a.height(),(s=i.offset().top)+i.height()<=r||n<=s))&&t.is(":hidden")&&(void 0!==p&&p.animate({"padding-top":"+="+e+"px"},250),t.fadeIn(250)),!d&&t.is(":visible")&&(void 0!==p&&p.animate({"padding-top":"-="+e+"px"},250),t.fadeOut(250)))}),l(document).on("click",".wppizza-reorder-purchase",function(a){if(a.preventDefault(),a.stopPropagation(),g()&&r){f();var t=l(this).attr("id");return k(wppizza.funcBeforeCartRefr,a),void jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"reorder",id:t,isCheckout:n}},function(a){void 0!==a.invalid&&console.log(a.invalid),void 0!==a.markup&&j(a.markup),m=a.cart,c("update_cart")},"json")}}),l(document).on("click",".wppizza-add-to-cart, .wppizza-add-to-cart-select",function(a){if(a.preventDefault(),a.stopPropagation(),!g())return!1;if(r){f();var t,i,e,p=l(this),o=p.attr("id");return void 0===wppizza.itm||void 0===wppizza.itm.fbatc||p.hasClass("wppizza-add-to-cart-btn")||(t=!0,i=p.html(),(e=p).hasClass("wppizza-do-reorder")&&(e=p.closest("td"),i=e.html(),t=!1),t&&p.removeClass("wppizza-add-to-cart"),p.fadeOut(100,function(){e.html("<div class='wppizza-item-added-feedback'>"+wppizza.itm.fbatc+"</div>").fadeIn(400).delay(wppizza.itm.fbatcms).fadeOut(400,function(){e.html(i).fadeIn(100),t&&p.addClass("wppizza-add-to-cart")})})),p.hasClass("wppizza-add-to-cart-select")&&(o=o.split("_").pop(-1)+"-"+p.closest("span").find("select").val()),k(wppizza.funcBeforeCartRefr,a),void jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"add",id:o,isCheckout:n}},function(a){void 0!==a.invalid&&console.log(a.invalid),void 0!==a.markup&&(j(a.markup),wppizza.shopOpen=a.is_open,setTimeout(g,10)),n&&void 0!==a.page_markup&&l(".wppizza-order-wrap").replaceWith(a.page_markup),m=a.cart,c("add")},"json")}}),l(document).on("click",".wppizza-remove-from-cart, .wppizza-delete-from-cart",function(a){a.preventDefault(),a.stopPropagation(),f();var t,i=l(this),e=i.attr("id");e.split("-").pop(-1);t=i.hasClass("wppizza-delete-from-cart")?0:-1,k(wppizza.funcBeforeCartRefr,a),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"modify",id:e,quantity:t,isCheckout:n}},function(a){void 0!==a.invalid&&console.log(a.invalid),void 0!==a.cart_markup&&(j(a.cart_markup),wppizza.shopOpen=a.is_open,setTimeout(g,10)),n&&void 0!==a.page_markup&&(l(".wppizza-order-wrap").replaceWith(a.page_markup),_()),m=a.cart,c("modify")},"json")}),l(document).on("keyup",".wppizza-cart-mod, .wppizza-item-qupdate",function(a){this.value=this.value.replace(/[^0-9]/g,"")});l(document).on("focus",".wppizza-cart-mod, .wppizza-item-qupdate",function(a){this.value.replace(/[^0-9]/g,"")}),l(document).on("blur",".wppizza-cart-mod, .wppizza-item-qupdate",function(a){this.value=this.value.replace(/[^0-9]/g,"")}),l(document).on("click",".wppizza-trigger-choose",function(a){wppizza.shopOpen&&r&&(w?wppizzaPrettifyJsAlerts(wppizza.msg.choosesize,"alert"):alert(wppizza.msg.choosesize))}),l(document).on("click",".wppizza-trigger-click",function(a){var t;wppizza.shopOpen&&r&&(t=(t=(t=this.id.split("-")).splice(2)).join("-"),target=l("#wppizza-"+t),target.trigger("click"))}),l(document).on("click",".wppizza-empty-cart-button",function(a){a.preventDefault(),a.stopPropagation(),f(),k(wppizza.funcBeforeCartRefr,a),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"empty",isCheckout:n}},function(a){void 0!==a.invalid&&console.log(a.invalid),void 0!==a.cart_markup&&(j(a.cart_markup),wppizza.shopOpen=a.is_open,setTimeout(g,10)),n&&void 0!==a.page_markup&&l(".wppizza-order-wrap").replaceWith(a.page_markup),m=a.cart,c("empty")},"json")});function E(a,t){var i=l(".wppizza-order-pickup"),e=l(".wppizza-toggle-pickup"),p=l(".wppizza-toggle-delivery"),o=e.closest("label"),r=p.closest("label");!0===a&&(i.attr("disabled",!0),e.attr("disabled",!0),p.attr("disabled",!0)),!1===a&&(i.attr("disabled",!1),e.attr("disabled",!1),p.attr("disabled",!1)),!0===t&&(i.attr("checked",!1),e.attr("checked",!0),p.attr("checked",!1),o.addClass("wppizza-pickup-toggle-selected"),r.removeClass("wppizza-pickup-toggle-selected")),!1===t&&(i.attr("checked",!0),e.attr("checked",!1),p.attr("checked",!0),o.removeClass("wppizza-pickup-toggle-selected"),r.addClass("wppizza-pickup-toggle-selected"))}l(document).on("change",".wppizza-order-pickup",function(a){if(!o&&!g())return;if(r||o){var t,i=l(this),e=void 0!==wppizza.opt&&void 0!==wppizza.opt.puDef;i.is(":radio")?t=1==i.val():(t=!!i.is(":checked"),e&&(t=!i.is(":checked")));var p=e!==t?!0:!1;if(E(!0,null),E(null,!!t),void 0!==wppizza.opt&&void 0!==wppizza.opt.puAlrt&&1==p&&(1==wppizza.opt.puAlrt&&(w?wppizzaPrettifyJsAlerts(wppizza.msg.pickup,"alert"):alert(wppizza.msg.pickup)),2==wppizza.opt.puAlrt&&!confirm(wppizza.msg.pickup)))return E(null,!(e&&t||!e&&t)),void E(!1,null);k(wppizza.funcBeforeCartRefr,a),f(),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"order-pickup",value:t,data:l("#wppizza-send-order").serialize(),isCheckout:n}},function(a){return n?(window.location.reload(!0),void(u=!0)):(void 0!==a.cart_markup&&(j(a.cart_markup),wppizza.shopOpen=a.is_open,o||setTimeout(g,10)),n&&void 0!==a.page_markup&&l(".wppizza-order-wrap").replaceWith(a.page_markup),l(".wppizza-orders-pickup-choice").replaceWith(a.cart_pickup_select),m=a.cart,void c("pickup-toggle"))},"json")}});var J=0,B=function(a){if(void 0!==wppizza.ofqc){var t="";n&&(t+=".wppizza-item-qupdate, ");var i,e,p=l(t+=".wppizza-cart-mod");if(p.spinner({min:0}),"load"==a&&0<wppizza.ajaxStart_count)return!1;p.focus(function(a){return a.preventDefault(),J=0,i=l(this).val(),spinner_element_id=l(this).attr("id").split("-").pop(-1),l(this).on("DOMMouseScroll mousewheel",function(a){return 0<a.originalEvent.detail||a.originalEvent.wheelDelta<0?0<parseInt(this.value)&&(this.value=parseInt(this.value,10)-1):this.value=parseInt(this.value,10)+1,!1}),!1}),p.keydown(function(a){if(e=l(this).val(),13==a.which||35==a.which)return l(this).blur(),!1}),p.blur(function(a){return e=l(this).val(),a.preventDefault(),a.stopPropagation(),0==J&&(i!=e&&l(this).change(),J++),!1})}};l(document).on("change",".wppizza-cart-mod, .wppizza-item-qupdate",function(a){a.preventDefault(),a.stopPropagation();var t=l(this),i=t.attr("id").split("-").pop(-1),e=t.val();R(e,i)});var Q=function(){n&&l("#"+z).validate({rules:wppizza.validate.rules,errorElement:"div",errorClass:"wppizza-validation-error error",ignore:":hidden, :disabled, .wppizza-ignore, .ignore",errorPlacement:function(a,t){var i=t.closest("div");a.appendTo(i)},invalidHandler:function(a,t){var i,e,p,o,r;t.numberOfInvalids()&&(i=l(t.errorList[0].element),o=(p=(e=l(window)).scrollTop())+e.height(),(r=i.offset().top)+i.height()<=o&&p<=r||l("html, body").animate({scrollTop:i.offset().top-50},300))},submitHandler:function(a,t){return l("#wppizza-ordernow").attr("disabled","true"),f(),I(),!1}})};B("load");var S,A,D,R=function(a,t,i){if(void 0!==i&&!0===i)return window.location.reload(!0),void(u=!0);var e,p;void 0!==t&&(f(),e=l(".wppizza-totals-container"),f(e,"wppizza-loading-small"),p="",n&&(p=l("#wppizza-send-order").serialize()),k(wppizza.funcBeforeCartRefr,"update"),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"update-order",id:t,quantity:a,isCheckout:n,data:p}},function(a){void 0!==a.invalid&&console.log(a.invalid),void 0!==a.cart_markup&&(j(a.cart_markup),wppizza.shopOpen=a.is_open,setTimeout(g,10)),void 0!==a.page_markup&&(l(".wppizza-order-wrap").replaceWith(a.page_markup),_()),m=a.cart,c("update-order")},"json"))};n&&(l("body").hasClass("wppizza-checkout")||l("body").addClass("wppizza-checkout"),Q(),jQuery.extend(jQuery.validator.messages,{required:wppizza.validate.error.required,email:wppizza.validate.error.email,decimal:wppizza.validate.error.decimal}),l.validator.methods.decimal=function(a,t){return this.optional(t)||/^(?:\d+|\d{1,3}(?:[\s\.,]\d{3})+)(?:[\.,]\d+)?$/.test(a)},l(document).on("change","#ctips_pc",function(a){var t=0;void 0!==wppizzaCartJson.summary.total.total&&(t=wppizzaCartJson.summary.total.total),void 0!==wppizzaCartJson.summary.tips.tips&&0<t&&(t-=wppizzaCartJson.summary.tips.tips);var i=void 0!==wppizzaCartJson.currency.decimals?wppizzaCartJson.currency.decimals:2,e=(e=""==l(this).val()||0==l(this).val()?0:t*(l(this).val()/100)).toFixed(i);l("#ctips").val(e).trigger("blur")}),l(document).on("keyup","#ctips",function(a){var t,i;8==a.which||35<=a.which&&a.which<=40||(i=(t=l(this)).val(),validate=i.replace(/[^0-9\.,]+/g,""),t.val(validate))}),S=l("#ctips"),A=l("#ctips_pc"),D=S.val(),l(document).on("focus","#ctips",function(a){D=l(this).val(),0<A.length&&l("#ctips_pc").val("")}),l(document).on("keydown","#ctips",function(a){if(13==event.which||35==event.which)return event.preventDefault(),l(this).blur(),!1}),l(document).on("blur","#ctips",function(a){return q(D),!1}));function W(){var a,t=h();""!=t&&(a="wppizza_"+t+"_init","function"==typeof(a=window[a])&&a())}var q=function(a){var t,i=l(this);a!=l("#ctips").val()&&(t=l("#wppizza-send-order").serialize(),i.attr("disabled","true"),f(),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"addtips",data:t,isCheckout:n}},function(a){void 0!==a.cart_markup&&(j(a.cart_markup),wppizza.shopOpen=a.is_open,setTimeout(g,10)),n&&void 0!==a.page_markup&&(l(".wppizza-order-wrap").replaceWith(a.page_markup),_()),m=a.cart,c("tips")},"json"))};s||W();var I=function(){var t=document.getElementById(z),e=s;l("#"+t.id).hasClass("wppizza-order-confirmed")&&(e=!1);var p=!!l("#"+t.id).hasClass("wppizza-order-confirmed"),o=l(t).serialize();if(void 0!==wppizza.fnBeforeOrderSubmit&&0<wppizza.fnBeforeOrderSubmit.length){var r=!0,n=[];for(i=0;i<wppizza.fnBeforeOrderSubmit.length;i++){var a=new Function("formid, data, must_confirm, is_confirmation_page","return "+wppizza.fnBeforeOrderSubmit[i]+"(formid, data, must_confirm, is_confirmation_page);")(t.id,o,e,p);n.push(a)}l.when.apply(l,n).then(function(a){return l.each(n,function(a,t){if(void 0!==t.responseJSON._wppizza_verify_on_submit&&void 0!==t.responseJSON._wppizza_verify_on_submit.continue&&!1===t.responseJSON._wppizza_verify_on_submit.continue)return r=t.responseJSON._wppizza_verify_on_submit,!1}),r}).done(function(a){N(a,o,t,e,p)})}else N(!0,o,t,e,p)},N=function(a,t,i,e,p){var o=l(".wppizza-order-wrap");if(void 0===a||void 0===a.continue||!1!==a.continue){if(e)jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"confirmorder",data:t}},function(a){o.replaceWith(a.markup).promise().done(function(a){W()});var t=l("#wppizza-send-order").offset().top;l("html, body").animate({scrollTop:t-100},300),m=!1},"json");else if(!e){var r=h();if(""==r)return console.log("no payment method selected"),!1;if(r!=y)return console.log("payment method mismatch"),!1;var n="wppizza_"+r+"_payment";if("function"==typeof(n=window[n]))return"undefined"!=typeof event&&event.stopPropagation(),u=!0,n(i.id,t,event),!1;jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"submitorder",gateway_selected:r,wppizza_data:t}},function(a){if(void 0===a.error)return void 0!==a.output?(console.log(a),void o.replaceWith(a.output)):void 0!==a.gateway?void 0!==a.gateway.form?(u=!0,void l(a.gateway.form).appendTo("body").submit()):void 0!==a.gateway.redirect?(u=!0,void(window.location.href=a.gateway.redirect)):void 0:void 0!==a.redirect_url?(u=!0,void(window.location.href=a.redirect_url)):void(m=!1);var i=[],e=[];l.each(a.error,function(a,t){i[a]=t.error_id,e[a]=t.error_message});var t='<div id="wppizza-order-error" class="wppizza-error">ERROR: '+i.join("|")+"<br /><br /></div>";return t+='<div id="wppizza-order-error-details" class="wppizza-error-details"><ul><li>'+e.join("</li><li>")+"</li></ul></div>",o.replaceWith(t),l("html,body").animate({scrollTop:0},300),void _()},"json")}}else{var s=void 0!==a.alert&&""!=a.alert&&a.alert,d=void 0!==a.element_id&&""!=a.element_id&&a.element_id;if(!p)return!1!==s&&(w?(s="<center>"+s.replace(/\./g,".<br>")+"</center>",wppizzaPrettifyJsAlerts(s,"invalid")):(s=""+s.replace(/\./g,"\n"),alert(s))),!1!==d&&M(d),void wppizzaRestoreOrder();if(p){l(".wppizza-loading").addClass("wppizza-load-redirect").removeClass("wppizza-loading"),!1!==s&&(s=""+s.replace(/\./g,"\n"),alert(s));var z=location.href.replace(location.hash,"");return!1!==d&&(z+="#"+d),window.location.href=z,void window.location.reload(!0)}}};t&&l(document).on("change",'input[name="wppizza_gateway_selected"]:radio, select[name="wppizza_gateway_selected"]',function(a){f();var t=l(this).val(),i=l("#wppizza-send-order").serialize();jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"changegateway",data:i,gateway_selected:t,isCheckout:n}},function(a){window.location.reload(!0),u=!0},"json")});var M=function(a){var t;!n||""!=(t=a||window.location.hash.substring(1))&&0<l("#"+t).length&&l("html, body").animate({scrollTop:l("#"+t).offset().top-100},1e3)};M(!1),l(document).on("change",".wppizza_account",function(a){l("#wppizza-user-register-info").toggle(200)}),l(document).on("click",".wppizza-login-show, .wppizza-login-cancel",function(a){a.preventDefault(),a.stopPropagation(),l(".wppizza-login-fieldset").slideToggle(300),l(".wppizza-login-option>a").toggle()}),a&&l(".wppizza-login-form > form ").validate({rules:{log:{required:!0},pwd:{required:!0}},errorElement:"div",errorClass:"wppizza-validation-error error",errorPlacement:function(a,t){var i=t.closest("p");a.appendTo(i)}}),l(document).on("click",".wppizza-login-form #wp-submit",function(a){a.preventDefault(),a.stopPropagation();var t,i,e,p,o=l(this),r=o.closest("form");r.valid()&&(t=r.serialize(),i=o.css("width"),e=o.css("height"),p=l(".wppizza-login-info"),o.attr("disabled","true").val("").addClass("wppizza-wait").css({width:i,height:e}),jQuery.post(wppizza.ajaxurl,{action:"wppizza_json",vars:{type:"user-login",data:t}},function(a){return void 0===a.error?(window.location.reload(!0),void(u=!0)):void 0!==a.error?(p.append(""+a.error).slideDown(250).delay(3500).slideUp(1e3,function(){p.empty()}),void o.removeAttr("disabled").val(a.button_value).removeClass("wppizza-wait")):void(m=!1)},"json"))}),l(document).on("click",".wppizza-transaction-details-orderhistory > legend",function(a){var t=l(this),i=t.closest("fieldset").find(".wppizza-order-details"),e=t.closest("fieldset").find(".wppizza-transaction-details");i.is(":visible")?(i.hide(),e.fadeIn()):(e.hide(),i.fadeIn())}),l(document).on("change",".wppizza-dd-categories > select",function(a){a.preventDefault(),a.stopPropagation();var t=l(this).val();t<=0||(window.location.href=t)})});